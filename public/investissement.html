<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projets d'Investissement - DSA Guelma</title>
    <link rel="stylesheet" href="assets/CSS/investissement_style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <link rel="stylesheet" href="assets/CSS/map-styles.css">
    <script src="assets/js/map-manager.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="profile-section">
                <div class="profile-pic">AD</div>
                <div class="profile-info">
                    <h3>Admin DSA</h3>
                    <p>admin@dsa-agriculture.dz</p>
                </div>
            </div>
            
            <ul class="nav-links">
                <li class="nav-item">
                    <a href="index.html">
                        <div class="nav-icon">üìä</div>
                        <span class="nav-text">TABLEAU DE BORD</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="projects.html">
                        <div class="nav-icon">üå±</div>
                        <span class="nav-text">PROJETS AGRICOLES</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
                <li class="nav-item active">
                    <a href="investissement.html">
                        <div class="nav-icon">üí∞</div>
                        <span class="nav-text">INVESTISSEMENT</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="electrification.html">
                        <div class="nav-icon">‚ö°</div>
                        <span class="nav-text">√âLECTRIFICATION</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="stats.html">  
                        <div class="nav-icon">üìà</div>
                        <span class="nav-text">STATISTIQUES</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="parametres.html">
                        <div class="nav-icon">‚öôÔ∏è</div>
                        <span class="nav-text">PARAM√àTRES</span>
                        <div class="active-indicator"></div>
                    </a>
                </li>
            </ul>
            
            <div class="active-users">
                <div class="users-count">24</div>
                <span>PROJETS ACTIFS</span>
            </div>
        </div>

        <!-- Contenu principal -->
        <div class="main-content">
            <!-- Header -->
            <div class="header">
                <div class="header-title">Direction des Services Agricoles - Guelma</div>
                <div class="header-actions">
                    <div class="time-widget">
                        <i class="fas fa-clock"></i>
                        <span id="current-time"></span>
                    </div>
                    <div class="cart-icon">
                        üõí
                        <div class="cart-badge">3</div>
                    </div>
                </div>
            </div>
            
            <!-- Page content -->
            <div class="page-content">
                <!-- Page header -->
                <div class="page-header">
                    <div class="page-title">
                        <h1>üí∞ Gestion des Investissements</h1>
                        <p>G√©rez et suivez tous vos projets d'investissement agricole</p>
                    </div>
                    <div class="page-controls-layout">
                        <!-- Zone de contr√¥les √† gauche -->
                        <div class="controls-section">
                            <!-- Champs de recherche et filtres (verticaux) -->
                            <div class="search-filters-vertical">
                                <div class="search-container">
                                    <i class="fas fa-search"></i>
                                    <input type="text" class="search-input" placeholder="Rechercher un investissement...">
                                </div>
                                <div class="filters-row">
                                    <select id="year-filter" class="filter-select">
                                        <option value="all">Toutes ann√©es</option>
                                        <option value="2023">2023</option>
                                        <option value="2024" selected>2024</option>
                                        <option value="2025">2025</option>
                                    </select>
                                    <select id="programme-filter" class="filter-select">
                                        <option value="all">Tous programmes</option>
                                        <option value="normal">Normal</option>
                                        <option value="psne">PSNE</option>
                                        <option value="hp">HP</option>
                                        <option value="urgence">Urgence</option>
                                        <option value="special">Sp√©cial</option>
                                        <option value="pcsc">PCSC</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Boutons (horizontaux) -->
                            <div class="buttons-row">
                                <div class="export-container">
                                    <button class="btn btn-export" id="export-btn">
                                        <i class="fas fa-download"></i>
                                        Exporter
                                    </button>
                                    <div class="export-dropdown" id="export-dropdown">
                                        <button class="export-option" id="export-pdf">
                                            <i class="fas fa-file-pdf"></i>
                                            PDF
                                        </button>
                                        <button class="export-option" id="export-excel">
                                            <i class="fas fa-file-excel"></i>
                                            Excel
                                        </button>
                                    </div>
                                </div>
                                <button class="btn btn-print" id="print-btn">
                                    <i class="fas fa-print"></i>
                                    Imprimer
                                </button>
                                <button class="btn btn-primary" id="add-investment-btn">
                                    <i class="fas fa-plus"></i>
                                    Nouvel investissement
                                </button>
                                <button class="btn btn-info" id="maps-btn">
                                    <i class="fas fa-map-marked-alt"></i>
                                    Carte des investissements
                                </button>
                            </div>
                        </div>
                        
                        <!-- Zone calendrier √† droite -->
                        <div class="calendar-section">
                            <div class="calendar-widget-compact">
                                <div class="calendar-header-compact">
                                    <button class="calendar-nav-compact" id="prev-month">
                                        <i class="fas fa-chevron-left"></i>
                                    </button>
                                    <h4 id="calendar-month-year">mai 2025</h4>
                                    <button class="calendar-nav-compact" id="next-month">
                                        <i class="fas fa-chevron-right"></i>
                                    </button>
                                </div>
                                <div class="calendar-days-header">
                                    <div class="calendar-day-header">Dim</div>
                                    <div class="calendar-day-header">Lun</div>
                                    <div class="calendar-day-header">Mar</div>
                                    <div class="calendar-day-header">Mer</div>
                                    <div class="calendar-day-header">Jeu</div>
                                    <div class="calendar-day-header">Ven</div>
                                    <div class="calendar-day-header">Sam</div>
                                </div>
                                <div class="calendar-grid-compact" id="calendar-grid-compact">
                                    <!-- Calendrier g√©n√©r√© dynamiquement -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Stats cards -->
                <div class="stats-section">
                    <h3>üìä Aper√ßu des Investissements</h3>
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üí∞</div>
                            <h3>Total des investissements</h3>
                            <div class="stat-value counter" data-target="24">0</div>
                            <p>Projets d'investissement</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üíé</div>
                            <h3>Budget total</h3>
                            <div class="stat-value counter" data-target="450">0</div>
                            <p>Millions DA</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">üí≥</div>
                            <h3>Montant engag√©</h3>
                            <div class="stat-value counter" data-target="320">0</div>
                            <p>Millions DA</p>
                        </div>
                        
                        <div class="stat-card">
                            <div class="stat-icon">‚úÖ</div>
                            <h3>Montant pay√©</h3>
                            <div class="stat-value counter" data-target="280">0</div>
                            <p>Millions DA</p>
                        </div>
                    </div>
                </div>

                
                
                <div class="table-container">
                    <div class="table-wrapper">
                        <table class="projects-table">
                            <thead>
                                <tr>
                                    <th>N¬∞ Op</th>
                                    <th>Intitul√©</th>
                                    <th>Programme</th>
                                    <th>Budget</th>
                                    <th>Engag√©</th>
                                    <th>Pay√©</th>
                                    <th>Restant</th>
                                    <th>Avancement</th>
                                    <th>Statut</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="investments-table-body">
                                <!-- Les donn√©es seront charg√©es dynamiquement -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal pour ajouter un investissement -->
    <div id="add-investment-modal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3><i class="fas fa-plus-circle"></i> Nouvel Investissement</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="add-investment-form" class="project-form" method="post">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="investment-numero">N¬∞ Op√©ration *</label>
                            <input type="text" id="investment-numero" name="numero" required placeholder="Ex: INV-2024-001">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-intitule">Intitul√© *</label>
                            <input type="text" id="investment-intitule" name="intitule" required placeholder="Intitul√© de l'investissement">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-programme">Programme *</label>
                            <select id="investment-programme" name="programme" required>
                            <option value="">S√©lectionner le programme</option>
                            <option value="normale">Normal</option> <!-- CORRECT -->
                            <option value="psre">PSRE</option>
                            <option value="special">Sp√©cial</option>
                            <option value="urgence">Urgence</option>
                            <option value="hp">HP</option>
                            <option value="pcsc">PCSC</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-annee">Ann√©e *</label>
                            <select id="investment-annee" name="annee" required>
                                <option value="">S√©lectionner l'ann√©e</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-budget">Budget (DA) *</label>
                            <input type="number" id="investment-budget" name="budget" required placeholder="0" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-engage">Montant Engag√© (DA)</label>
                            <input type="number" id="investment-engage" name="engage" placeholder="0" step="0.01" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-paye">Montant Pay√© (DA)</label>
                            <input type="number" id="investment-paye" name="paye" placeholder="0" step="0.01" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-avancement">Avancement (%)</label>
                            <input type="number" id="investment-avancement" name="avancement" placeholder="0" min="0" max="100" value="0">
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-statut">Statut *</label>
                             <select id="investment-statut" name="statut" required>
                                <option value="planifie">Planifi√©</option> <!-- sera transform√© en "non lanc√©" -->
                                <option value="en-cours">En cours</option> <!-- ‚Üí "lanc√©" -->
                                <option value="termine">Termin√©</option>   <!-- ‚Üí "cl√¥tur√©" -->
                                <option value="annule">Annul√©</option>     <!-- ‚Üí "abandonn√©" -->
                                <option value="suspendu">Suspendu</option> <!-- ‚Üí "abandonn√©" -->
                             </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-daira">Da√Øra</label>
                            <select id="investment-daira" name="daira">
                                <option value="">S√©lectionner la da√Øra</option>
                                <option value="guelma">Guelma</option>
                                <option value="oued-zenati">Oued Zenati</option>
                                <option value="heliopolis">H√©liopolis</option>
                                <option value="bouchegouf">Bouchegouf</option>
                                <option value="hammam-debagh">Hammam Debagh</option>
                                <option value="ain-makhlouf">Ain Makhlouf</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="investment-commune">Commune</label>
                            <select id="investment-commune" name="commune">
                                <option value="">S√©lectionner la commune</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="investment-beneficiaire">B√©n√©ficiaire</label>
                            <input type="text" id="investment-beneficiaire" name="beneficiaire" placeholder="Nom du b√©n√©ficiaire">
                        </div>
                    </div>
                    
                    <div class="dates-section">
                        <h4><i class="fas fa-calendar"></i> Dates importantes</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="investment-date-debut">Date de d√©but</label>
                                <input type="date" id="investment-date-debut" name="dateDebut">
                            </div>
                            
                            <div class="form-group">
                                <label for="investment-date-fin">Date de fin pr√©vue</label>
                                <input type="date" id="investment-date-fin" name="dateFin">
                            </div>
                            
                            <div class="form-group">
                                <label for="investment-date-engagement">Date d'engagement</label>
                                <input type="date" id="investment-date-engagement" name="dateEngagement">
                            </div>
                            
                            <div class="form-group">
                                <label for="investment-date-paiement">Date de paiement</label>
                                <input type="date" id="investment-date-paiement" name="datePaiement">
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="investment-description">Description</label>
                        <textarea id="investment-description" name="description" rows="4" placeholder="Description d√©taill√©e de l'investissement"></textarea>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancel-add">
                            <i class="fas fa-times"></i>
                            Annuler
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            Enregistrer
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal pour modifier un investissement -->
    <div id="edit-investment-modal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3><i class="fas fa-edit"></i> Modifier l'Investissement</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <form id="edit-investment-form" class="project-form">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="edit-investment-numero">N¬∞ Op√©ration *</label>
                            <input type="text" id="edit-investment-numero" name="numero" required readonly>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-intitule">Intitul√© *</label>
                            <input type="text" id="edit-investment-intitule" name="intitule" required>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-programme">Programme *</label>
                            <select id="investment-programme" name="programme" required>
                            <option value="">S√©lectionner le programme</option>
                            <option value="normale">Normal</option> <!-- CORRECT -->
                            <option value="psre">PSRE</option>
                            <option value="special">Sp√©cial</option>
                            <option value="urgence">Urgence</option>
                            <option value="hp">HP</option>
                            <option value="pcsc">PCSC</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-annee">Ann√©e *</label>
                            <select id="edit-investment-annee" name="annee" required>
                                <option value="">S√©lectionner l'ann√©e</option>
                                <option value="2023">2023</option>
                                <option value="2024">2024</option>
                                <option value="2025">2025</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-budget">Budget (DA) *</label>
                            <input type="number" id="edit-investment-budget" name="budget" required step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-engage">Montant Engag√© (DA)</label>
                            <input type="number" id="edit-investment-engage" name="engage" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-paye">Montant Pay√© (DA)</label>
                            <input type="number" id="edit-investment-paye" name="paye" step="0.01">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-avancement">Avancement (%)</label>
                            <input type="number" id="edit-investment-avancement" name="avancement" min="0" max="100">
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-statut">Statut *</label>
                            <select id="edit-investment-statut" name="statut" required>
                                <option value="en-cours">En cours</option>
                                <option value="planifie">Planifi√©</option>
                                <option value="termine">Termin√©</option>
                                <option value="suspendu">Suspendu</option>
                                <option value="annule">Annul√©</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-daira">Da√Øra</label>
                            <select id="edit-investment-daira" name="daira">
                                <option value="">S√©lectionner la da√Øra</option>
                                <option value="guelma">Guelma</option>
                                <option value="oued-zenati">Oued Zenati</option>
                                <option value="heliopolis">H√©liopolis</option>
                                <option value="bouchegouf">Bouchegouf</option>
                                <option value="hammam-debagh">Hammam Debagh</option>
                                <option value="ain-makhlouf">Ain Makhlouf</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-commune">Commune</label>
                            <select id="edit-investment-commune" name="commune">
                                <option value="">S√©lectionner la commune</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-investment-beneficiaire">B√©n√©ficiaire</label>
                            <input type="text" id="edit-investment-beneficiaire" name="beneficiaire">
                        </div>
                    </div>
                    
                    <div class="dates-section">
                        <h4><i class="fas fa-calendar"></i> Dates importantes</h4>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="edit-investment-date-debut">Date de d√©but</label>
                                <input type="date" id="edit-investment-date-debut" name="dateDebut">
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-investment-date-fin">Date de fin pr√©vue</label>
                                <input type="date" id="edit-investment-date-fin" name="dateFin">
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-investment-date-engagement">Date d'engagement</label>
                                <input type="date" id="edit-investment-date-engagement" name="dateEngagement">
                            </div>
                            
                            <div class="form-group">
                                <label for="edit-investment-date-paiement">Date de paiement</label>
                                <input type="date" id="edit-investment-date-paiement" name="datePaiement">
                            </div>
                        </div>
                    </div>
                    
                    <div class="observations-section">
                        <h4><i class="fas fa-clipboard-list"></i> Observations</h4>
                        <div class="observations-list" id="edit-observations-list">
                            <!-- Les observations existantes seront affich√©es ici -->
                        </div>
                        <div class="form-group">
                            <label for="edit-new-observation">Nouvelle observation</label>
                            <textarea id="edit-new-observation" name="newObservation" rows="3" placeholder="Ajouter une nouvelle observation..."></textarea>
                        </div>
                        <div class="observation-controls">
                            <button type="button" class="btn btn-sm btn-secondary" id="toggle-observations">
                                <i class="fas fa-eye"></i>
                                Voir toutes les observations
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group full-width">
                        <label for="edit-investment-description">Description</label>
                        <textarea id="edit-investment-description" name="description" rows="4"></textarea>
                    </div>
                    
                    <div class="modal-actions">
                        <button type="button" class="btn btn-secondary" id="cancel-edit">
                            <i class="fas fa-times"></i>
                            Annuler
                        </button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            Sauvegarder
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modal pour les d√©tails de l'investissement -->
    <div id="investment-details-modal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3><i class="fas fa-info-circle"></i> D√©tails de l'investissement</h3>
                <div class="modal-header-actions">
                    <button class="btn btn-sm btn-secondary" id="print-details-btn">
                        <i class="fas fa-print"></i>
                        Imprimer
                    </button>
                    <button class="btn btn-sm btn-export" id="export-details-btn">
                        <i class="fas fa-download"></i>
                        Exporter
                    </button>
                    <button class="modal-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="modal-body project-details-content">
                <!-- Le contenu sera charg√© dynamiquement -->
            </div>
        </div>
    </div>

    <!-- Modal pour la carte Google Maps -->
    <div id="map-modal" class="modal">
        <div class="modal-backdrop"></div>
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3><i class="fas fa-map-marked-alt"></i> Carte des Investissements</h3>
                <button class="modal-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div id="map-container" style="width: 100%; height: 500px; border-radius: 8px; overflow: hidden;">
                    <div style="display: flex; align-items: center; justify-content: center; height: 100%; background-color: #f8f9fa;">
                        <div style="text-align: center;">
                            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: #2d4f4f; margin-bottom: 1rem;"></i>
                            <p>Chargement de la carte...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/investissement_script.js"></script>
</body>
</html>
